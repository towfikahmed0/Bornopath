<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Install Bornopath</title>
    <meta name="theme-color" content="#159895">
    <link rel="manifest" href="/manifest.json">
    <link rel="icon" href="/icons/icon-192.png">
      <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">

    <!-- Tailwind CSS & Inter font -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap">
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'bornopath-teal': '#159895',
                        'bornopath-teal-dark': '#127a77',
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                },
            },
        }
    </script>

    <style>
        body {
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            background-color: #f9fdfd;
            font-family: 'Inter', sans-serif;
        }

        .icon-download {
            width: 1em;
            height: 1em;
            display: inline-block;
            vertical-align: middle;
            fill: none;
            stroke: currentColor;
            stroke-width: 2;
            stroke-linecap: round;
            stroke-linejoin: round;
        }
    </style>
</head>

<body>

    <div class="bg-white p-8 sm:p-10 rounded-xl shadow-2xl max-w-sm w-full text-center transition-all duration-300">
        <img src="/icons/icon-192.png" alt="Bornopath Logo" width="80" height="80"
            class="mx-auto mb-6 rounded-full shadow-md"
            onerror="this.onerror=null; this.src='https://placehold.co/80x80/159895/ffffff?text=B'">
        <h1 class="text-3xl font-bold mb-2 text-gray-800">Install <span class="text-bornopath-teal">Bornopath</span>
        </h1>
        <p class="text-gray-500 mb-6 text-base">Add Bornopath to your home screen for quick access and an immersive app
            experience.</p>
        <div class="alert alert-primary" role="alert">
            Current Version: <strong>BornoPath v1.4.0</strong>.
        </div>

        <button id="installBtn"
            class="w-full flex items-center justify-center space-x-2 bg-bornopath-teal text-white font-semibold py-3 px-6 rounded-full shadow-lg transition duration-200 hover:bg-bornopath-teal-dark hover:shadow-xl focus:outline-none focus:ring-4 focus:ring-bornopath-teal/50"
            style="display: block;">
            <svg class="icon-download text-lg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                <polyline points="7 10 12 15 17 10"></polyline>
                <line x1="12" y1="15" x2="12" y2="3"></line>
            </svg>
            <span>Install Bornopath</span>
        </button>
    </div>

    <script>
        // Redirect immediately if already running as PWA
        if (window.matchMedia('(display-mode: standalone)').matches || window.navigator.standalone === true) {
            window.location.replace("/index.html");
        }

        let deferredPrompt;
        const installBtn = document.getElementById("installBtn");

        // Listen for beforeinstallprompt event
        window.addEventListener("beforeinstallprompt", (e) => {
            e.preventDefault();
            deferredPrompt = e;
            installBtn.style.display = "flex"; // show install button
        });

        // Handle install button click
        installBtn.addEventListener("click", async () => {
            if (deferredPrompt) {
                deferredPrompt.prompt();
                const { outcome } = await deferredPrompt.userChoice;
                if (outcome === "accepted") {
                    installBtn.style.display = "none";
                    window.location.replace("/index.html");
                }
                deferredPrompt = null;
            } else {
                console.log("Install prompt not available");
                installBtn.innerText = "Redirecting...";
                window.location.replace("/index.html");

            }
        });


        // Handle appinstalled event
        window.addEventListener("appinstalled", () => {
            installBtn.style.display = "none";
            console.log("Bornopath PWA installed");
            window.location.replace("/index.html");
        });

        if (installBtn.style.display === "none") {
            console.log("Install button hidden, redirecting...");
            window.location.replace("/index.html");
        }

    </script>

</body>

</html>
